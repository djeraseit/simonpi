version: '3'
networks:
    lwm2m-net:
        driver: bridge
services:
    simonpi.rpi3.client:
        container_name: client
        image: 'm0rf30/simonpi:lwm2m'
        tty: true
        environment:
            - EXTERPORT2=5663
            - EXTERPORT3=5664
            - EXTERPORT4=56630
        command: 'simonpi rpi-3 -i /root/.simonpi/lwm2m-aarch64-client.img'
        privileged: true
        volumes:
            - '/dev:/dev'
            - '~/lwm2m-client:/root/.simonpi'
        depends_on:
            - simonpi.rpi3.server
        networks:
            - lwm2m-net
        ports:
            - '5663:5683/udp'
            - '5664:5684/udp'
            - '56630:56830/udp'
        links:
            - simonpi.rpi3.server
    simonpi.rpi3.server:
        container_name: server
        image: 'm0rf30/simonpi:lwm2m'
        tty: true
        command: 'simonpi rpi-3 -i /root/.simonpi/lwm2m-aarch64-server.img'
        privileged: true
        volumes:
            - '/dev:/dev'
            - '~/lwm2m-server:/root/.simonpi'
        networks:
            - lwm2m-net
        ports:
            - '8080:8080'
            - '5683:5683/udp'
            - '5684:5684/udp'
            - '56830:56830/udp'

