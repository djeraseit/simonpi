version: '3'
networks:
    lwm2m-net:
        driver: bridge
services:
    simonpi.rpi3.client:
        container_name: client
        image: 'm0rf30/simonpi:lwm2m'
        tty: true
        command: 'simonpi rpi-3 -i /root/.simonpi/lwm2m-aarch64-client.img'
        volumes:
            - '/dev:/dev'
            - '~/lwm2m-client:/root/.simonpi'
        depends_on:
            - simonpi.rpi3.server
        networks:
            - lwm2m-net
        ports:
            - '5693:5683/udp'
            - '5694:5684/udp'
            - '56930:56830/udp'
        links:
            - simonpi.rpi3.server
    simonpi.rpi3.server:
        container_name: server
        image: 'm0rf30/simonpi:lwm2m'
        tty: true
        command: 'simonpi rpi-3 -i /root/.simonpi/lwm2m-aarch64-server.img'
        volumes:
            - '/dev:/dev'
            - '~/lwm2m-server:/root/.simonpi'
        networks:
            - lwm2m-net
        ports:
            - '8080:8080'
            - '5673:5683/udp'
            - '5674:5684/udp'
            - '56730:56830/udp'

