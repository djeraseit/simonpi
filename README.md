
           __                                                                        __
      ____/\_\    ___ ___                      ___     ___                    _____ /\_\
     /',__\/\ \ /' __` __`\      _______      / __`\ /' _ `\      _______    /\ '__`\/\ \
    /\__, `\ \ \/\ \/\ \/\ \    /\______\    /\ \L\ \/\ \/\ \    /\______\   \ \ \L\ \ \ \
    \/\____/\ \_\ \_\ \_\ \_\   \/______/    \ \____/\ \_\ \_\   \/______/    \ \ ,__/\ \_\
     \/___/  \/_/\/_/\/_/\/_/                 \/___/  \/_/\/_/                 \ \ \/  \/_/
                                                                                \ \_\
                                                                                 \/_/




# Description
A quick & dirty script to emulate Raspberry family devices on your laptop.
It generates a valid sdcard image that could be deployed on real hardware and used as virtual storage for QEMU.

## Some features
* It can run a custom image generated by third parties adopting the classic Raspberry Pi partition table. 
* Use OVMF UEFI images for rpi-2 & rpi-3
* Almost full KVM acceleration for aarch64
* Latest stable Linux kernels for every supported platform
* Basic Networking support 
* Docker image and example docker-compose file for quick deploy
* SSH guest access

Powered with :heart: by Arch Linux Arm images

# In action with a Raspbian image
[![asciicast](https://asciinema.org/a/EdrHT8X04hIJx4VOUKTgl1RJE.png)](https://asciinema.org/a/EdrHT8X04hIJx4VOUKTgl1RJE)

# Instructions
1. Download the sources and go into the simonpi directory
 
```git clone https://github.com/M0Rf30/simonpi.git```

```cd simonpi```

2. Set permissions for QEMU bridge interface
  
```sudo echo "allow rasp-br0 >> /etc/qemu/bridge.conf```

3. Download the required OVMF images:
    
    for rpi-2 (arch=ARM)

        http://snapshots.linaro.org/components/kernel/leg-virt-tianocore-edk2-upstream/latest/QEMU-ARM/RELEASE_GCC5/QEMU_EFI.fd

    for rpi-3 (arch=AARCH64)

        http://snapshots.linaro.org/components/kernel/leg-virt-tianocore-edk2-upstream/latest/QEMU-AARCH64/RELEASE_GCC5/QEMU_EFI.fd

    and place them respectively in the follow path:
    
        /usr/share/OVMF/$arch/QEMU_EFI.fd

4. Type:

```./simonpi -h for details```
    
and follow the help guidelines

# Deployment
All the assets (disk images, downloaded archives..) are saved in 
```~/.simonpi``` by default.

You can transfer your sd img on a valid sdcard using this command:

```dd if=sd-arch-MODEL-qemu.img of=/dev/sdX bs=4M```

where MODEL could be:
* rpi
* rpi-2
* rpi-3

and X could be mmcblk0 or other block devices

## For Arch Linux users
You can find sim-on-pi on AUR

Type:

```yaourt -S simonpi-git```

and that's all!

## Docker image
See the **How to** into **docker** folder

# PR
* Fork it 
* Modify it
* TEST it
* Do a Pull Request

Any suggestions are welcome

# Used Kernels
Take a look here for adopted Kernel images:

https://github.com/M0Rf30/qemu-kernels-rpi-arch-arm
